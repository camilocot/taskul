{% extends "UserBundle::layout.html.twig" %}

{% block fos_user_content %}

<div class="row-fluid">

    <div class="row-fluid">
        <div class="login-box">
            <div class="icons">
                <a href="{{ path('homepage') }}"><i class="icon-home"></i></a>
            </div>


            <h2>Login to your account</h2>
            <form action="{{ path("fos_user_security_check") }}" method="post" class="form-horizontal" id="login-form">

                <fieldset>
                        <div class="input-prepend" title="Username">
                            <span class="add-on"><i class="icon-user"></i></span>
                            <input class="input-large span10" id="username"  name="_username" value="{{ last_username }}" type="text" placeholder="type username"/>
                        </div>
                    <div class="clearfix"></div>
                    <div class="control-group  {% if error %} error {% endif %}">
                    <div class="input-prepend" title="Password">
                        <span class="add-on"><i class="icon-lock"></i></span>
                        <input class="input-large span10" id="password" type="password" placeholder="type password" name="_password" />
                    </div>
                    {% if error %}
                    <div class="help-inline" ><p>{{ error|trans({}, 'FOSUserBundle') }}</p></div>
                    {% endif %}
                    </div>
                    <div class="clearfix"></div>

                    <label class="remember" for="remember"><input type="checkbox" id="remember" name="_remember_me"/>{{ 'security.login.remember_me'|trans({}, 'FOSUserBundle') }}</label>

                    <div class="button-login">
                        <button type="submit" class="btn btn-primary" name="_submit" ><i class="icon-off icon-white"></i> {{ 'security.login.submit'|trans({}, 'FOSUserBundle') }}</button>
                    </div>
                    <div class="clearfix"></div>
                </fieldset>
                <input type="hidden" name="_csrf_token" value="{{ csrf_token }}" />
            </form>
            <hr>
            {% include "UserBundle:Helper:facebook_button.html.twig" %}

            <hr>
            <h3>Forgot Password?</h3>
            <p>
                No problem, <a href="{{ path("fos_user_resetting_request") }}">click here</a> to get a new password.
            </p>
            <hr>
            <h3>Register</h3>
            <p>
                No problem, <a href="{{ path("fos_user_registration_register") }}">click here</a>.
            </p>
        </div><!--/span-->
    </div><!--/row-->

</div><!--/fluid-row-->

{% endblock %}
{% block javascripts %}
<script src="http://malsup.github.com/jquery.form.js"></script>
<script>
        // wait for the DOM to be loaded
        $(document).ready(function() {
            // bind 'myForm' and provide a simple callback function
            $('#login-form').ajaxForm(function(e) {
                status = ( e.success ) ? 'success' : 'error';
                noty({text: e.message, type: status, layout: 'top'});
                if(status == 'success')
                    setTimeout(function() {
                        window.location.href = "{{ path('task') }}";
                }, 2000);
            });
        });
    </script>
{% endblock %}
