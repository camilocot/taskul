{% extends app.request.isXmlHttpRequest ? "::base_ajax.html.twig" : "MessageBundle::layout.html.twig" %}

{% block content %}
{{ apy_breadcrumb_trail_render() }}
<div class="row-fluid sortable">
    <div class="box span6">
        <div class="box-header" data-original-title>
            <h2><i class="icon-user"></i><span class="break"></span>Conversación</h2>
            <div class="box-icon">
                <a href="#" class="btn-minimize"><i class="icon-chevron-up"></i></a>
            </div>
        </div>
        <div class="box-content">
            <h2>Asunto: {{ thread.subject }}</h2>
            {% for message in thread.messages %}
            <div class="messenger_thread_message">
                <div class="messenger_thread_message_info">
                    {% trans with {'%sender%': message.sender|e, '%date%': message.createdAt|date} from 'FOSMessageBundle' %}by{% endtrans %}
                </div>

                <div class="messenger_thread_message_body" id="message_{{ message.id }}">
                    {{ message.body|raw }}
                    <hr/>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <div class="box span6">
        <div class="box-header" data-original-title>
            <h2><i class="icon-user"></i><span class="break"></span>Responder</h2>
            <div class="box-icon">
                <a href="#" class="btn-minimize"><i class="icon-chevron-up"></i></a>
            </div>
        </div>
        <div class="box-content">
            <h3>{% trans from 'FOSMessageBundle' %}reply{% endtrans %}</h3>

            <form action="{{ url('fos_message_thread_view', {'threadId': thread.id}) }}" method="post" class="form-horizontal validate" id="form_thread">
                <fieldset>
                    {{ form_row(form.body, {'attr':
                    {'placeholder':'Introduzca una descripción ...', 'class':'nicEdit span11','rows':'10','minlength':'8' } } ) }}

                    {{ form_rest(form) }}
                </fieldset>
                <div class="form-actions">
                    <button class="btn btn-primary ajaxy" type="submit"><i class="fa-icon-envelope"></i>&nbsp;Enviar</button>
                </div>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}
{% block javascripts %}
{{ parent() }}
{% javascripts
    '@MessageBundle/Resources/public/js/thread.js'
    %}
    <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock %}
